allow init servicemanager:binder { call };
allow init proc:lnk_file { setattr };
allow init vendor_file:file execute_no_trans;
allow init system_data_file:lnk_file r_file_perms;
allow init hwservicemanager:binder { call transfer };
allow init hal_power_hwservice:hwservice_manager add;
allow init sysfs_kgsl:lnk_file read;
allow init hidl_base_hwservice:hwservice_manager add;
#allow init device_latency:chr_file { open write };

# Allow init to chown/chmod on pseudo files in /sys
allow init sysfs_type:file { open read write setattr };

allow init { netd domain tzdatacheck vendor_init ueventd tee fsck lmkd crash_dump }:process noatsecure;

dontaudit init kernel:system module_request;

allow init init:capability2 { block_suspend } ;
allow init init:netlink_generic_socket { read } ;
allow init init:netlink_generic_socket { write } ;
allow init init:netlink_kobject_uevent_socket { read } ;
allow init init:netlink_route_socket { read } ;
allow init init:socket { read } ;
allow init init:socket { write } ;
allow init init:tcp_socket { create } ;
allow init init:tcp_socket { ioctl } ;
allow init mnt_vendor_file:lnk_file { read } ;
allow init netutils_wrapper_exec:file { execute } ;
allow init netutils_wrapper_exec:file { execute_no_trans } ;
allow init netutils_wrapper_exec:file { getattr } ;
allow init netutils_wrapper_exec:file { read open } ;
allow init system_app:binder { call } ;
allow init system_file:file { execute_no_trans } ;

allow init at_device:chr_file { open } ;
allow init at_device:chr_file { read write } ;
allow init qdsp_device:chr_file { ioctl } ;
allow init sg_device:chr_file { ioctl } ;
allow init sg_device:chr_file { open } ;
allow init sg_device:chr_file { read write } ;
allow init tee_device:chr_file { ioctl } ;

allow init init:netlink_route_socket { bind } ;
allow init init:netlink_route_socket { create } ;
allow init init:netlink_route_socket { getattr } ;
allow init init:netlink_route_socket { setopt } ;

allow init at_device:chr_file { ioctl } ;
allow init audio_device:chr_file { ioctl } ;
allow init audio_device:chr_file { open } ;
allow init audio_device:chr_file { read write } ;
allow init block_device:blk_file { write } ;
allow init debugfs_rmt_storage:dir { relabelfrom } ;
allow init debugfs_rmt_storage:file { relabelfrom } ;
allow init device:chr_file { ioctl } ;
allow init device:chr_file { open } ;
allow init device:chr_file { read write } ;
allow init hal_gnss_qti:unix_dgram_socket { sendto } ;
allow init hal_wifi_supplicant_default:unix_dgram_socket { sendto } ;
allow init ims_socket:sock_file { write } ;
allow init init:binder { call } ;
allow init init:binder { transfer } ;
allow init init:capability { net_bind_service } ;
allow init init:capability { sys_module } ;
allow init init:netlink_generic_socket { bind } ;
allow init init:netlink_generic_socket { create } ;
allow init init:netlink_generic_socket { getattr } ;
allow init init:netlink_generic_socket { setopt } ;
allow init init:netlink_kobject_uevent_socket { bind } ;
allow init init:netlink_kobject_uevent_socket { create } ;
allow init init:netlink_kobject_uevent_socket { getopt } ;
allow init init:netlink_kobject_uevent_socket { setopt } ;
allow init init:netlink_route_socket { getopt } ;
allow init init:netlink_route_socket { nlmsg_read } ;
allow init init:netlink_route_socket { nlmsg_write } ;
allow init init:netlink_route_socket { write } ;
allow init init:netlink_socket { bind } ;
allow init init:netlink_socket { create } ;
allow init init:netlink_socket { read } ;
allow init init:netlink_socket { write } ;
allow init init:netlink_tcpdiag_socket { bind } ;
allow init init:netlink_tcpdiag_socket { create } ;
allow init init:netlink_tcpdiag_socket { getopt } ;
allow init init:netlink_tcpdiag_socket { setopt } ;
allow init init:netlink_xfrm_socket { bind } ;
allow init init:netlink_xfrm_socket { create } ;
allow init init:rawip_socket { create } ;
allow init init:rawip_socket { getopt } ;
allow init init:rawip_socket { setopt } ;
allow init init:socket { bind } ;
allow init init:socket { connect } ;
allow init init:socket { create } ;
allow init init:socket { ioctl } ;
allow init init:tcp_socket { bind } ;
allow init init:tcp_socket { getattr } ;
allow init init:tcp_socket { listen } ;
allow init init:tcp_socket { setopt } ;
allow init init:udp_socket { bind } ;
allow init init:udp_socket { getattr } ;
allow init init:udp_socket { getopt } ;
allow init init:udp_socket { ioctl } ;
allow init init:udp_socket { read } ;
allow init init:udp_socket { setopt } ;
allow init init:udp_socket { write } ;
allow init ion_device:chr_file { ioctl } ;
allow init ion_device:chr_file { open } ;
allow init ion_device:chr_file { read } ;
allow init ipa_dev:chr_file { ioctl } ;
allow init ipa_dev:chr_file { open } ;
allow init ipa_dev:chr_file { read write } ;
allow init ipa_vendor_data_file:file { lock } ;
allow init firmware_file:dir {mounton setattr};
allow init location_data_file:file { ioctl } ;
allow init location_data_file:file { lock } ;
allow init location_socket:sock_file { write } ;
allow init netd:binder { call } ;
allow init netmgrd_socket:sock_file { write } ;
allow init node:tcp_socket { node_bind } ;
allow init node:udp_socket { node_bind } ;
allow init persist_rfs_file:file { rename } ;
allow init port:tcp_socket { name_bind } ;
allow init port:udp_socket { name_bind } ;
allow init qdsp_device:chr_file { open } ;
allow init qdsp_device:chr_file { read } ;
allow init qti_debugfs:file { write } ;
allow init rmnet_device:chr_file { ioctl } ;
allow init rmnet_device:chr_file { open } ;
allow init rmnet_device:chr_file { read write } ;
allow init rtc_device:chr_file { ioctl } ;
allow init rtc_device:chr_file { read } ;
allow init rtc_device:chr_file { read open } ;
allow init ssr_device:chr_file { open } ;
allow init ssr_device:chr_file { read } ;
allow init sysfs_wake_lock:file { append } ;
allow init tee_device:chr_file { open } ;
allow init tee_device:chr_file { read write } ;
allow init uio_device:chr_file { open } ;
allow init uio_device:chr_file { read write } ;
allow init vendor_radio_data_file:dir { mounton } ;
allow init vndbinder_device:chr_file { ioctl } ;
allow init vndbinder_device:chr_file { open } ;
allow init vndbinder_device:chr_file { read } ;
allow init vndbinder_device:chr_file { write } ;
allow init vndservicemanager:binder { call } ;
allow init vndservicemanager:binder { transfer } ;

allow init wpa_socket:sock_file { write } ;
allow init fwmarkd_socket:sock_file { write } ;
allow init hal_gnss_qti:binder { call } ;
allow init init:udp_socket { ioctl } ;
allow init netd:unix_stream_socket { connectto } ;
allow init rild:binder { call } ;
allow init system_file:file { mounton } ;

allow init init:udp_socket { ioctl } ;

allow init system_suspend_hwservice:hwservice_manager find;
